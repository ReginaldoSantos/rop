<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Rop by ryenus</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Rop</h1>
        <p>A lightweight command line option parser written in Java</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/ryenus/rop" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/ryenus/rop/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/ryenus/rop/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>Rop</h1>

<p><a href="https://travis-ci.org/ryenus/rop"><img src="https://travis-ci.org/ryenus/rop.png?branch=master" alt="Build Status"></a></p>

<p>Rop is a lightweight command line option parser written in Java.</p>

<h2>Introduction</h2>

<p>Rop is designed to be minimal meanwhile convenient, to cover most usual command line parsing use cases. You can use Rop to build command line programs like:</p>

<ul>
<li>
<p><code>mv</code> and <code>ls</code></p>

<ul>
<li>simple commands that just do one thing</li>
</ul>
</li>
<li>
<p><code>git add</code>, <code>git commit</code></p>

<ul>
<li>sub-commands, but single invocation</li>
</ul>
</li>
<li>
<p><code>mvn clean test</code></p>

<ul>
<li>sub-commands with multiple invocations</li>
</ul>
</li>
</ul><p>More importantly, Rop endorses building command line option parsers the Java way. Instead of following the traditional <a href="http://en.wikipedia.org/wiki/Getopt">GetOpt</a> way of building an option parser, Rop follows an approache that is:</p>

<ul>
<li>Annotation based, and</li>
<li>Object-oriented</li>
</ul><p>You can build an option parser by defining Command classes and their fields annotated with the corresponding Option switches.</p>

<p>Also, each Command can optionally have a <code>run()</code> method to define its behavior, which would be called by the parser automatically.</p>

<h3>How to start?</h3>

<p>Rop is available as a Maven artifact <code>com.github.ryenus:rop</code>. Simply add this to the dependencies section in your pom.xml:</p>

<div class="highlight"><pre><span class="nt">&lt;dependency&gt;</span>
    <span class="nt">&lt;groupId&gt;</span>com.github.ryenus<span class="nt">&lt;/groupId&gt;</span>
    <span class="nt">&lt;artifactId&gt;</span>rop<span class="nt">&lt;/artifactId&gt;</span>
    <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
<span class="nt">&lt;/dependency&gt;</span>
</pre></div>

<p>Note that '1.0' might not be the latest version when you're reading this.</p>

<p>You can always get the latest source code from <a href="https://github.com/ryenus/rop">https://github.com/ryenus/rop</a>.</p>

<h3>Usage example</h3>

<p>Here's a quick example to demonstrate how to use Rop:</p>

<div class="highlight"><pre><span class="kn">import</span> <span class="nn">com.github.ryenus.rop.OptionParser</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.github.ryenus.rop.OptionParser.Command</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">com.github.ryenus.rop.OptionParser.Option</span><span class="o">;</span>

<span class="nd">@Command</span><span class="o">(</span><span class="n">name</span> <span class="o">=</span> <span class="s">"foo"</span><span class="o">,</span> <span class="n">description</span> <span class="o">=</span> <span class="s">"A simple command with a few options."</span><span class="o">)</span>
<span class="kd">class</span> <span class="nc">FooCommand</span> <span class="o">{</span>
    <span class="nd">@Option</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"explain what is being done"</span><span class="o">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-V"</span><span class="o">,</span> <span class="s">"--verbose"</span> <span class="o">})</span>
    <span class="kt">boolean</span> <span class="n">verbose</span><span class="o">;</span>

    <span class="nd">@Option</span><span class="o">(</span><span class="n">description</span> <span class="o">=</span> <span class="s">"certain number"</span><span class="o">,</span> <span class="n">opt</span> <span class="o">=</span> <span class="o">{</span> <span class="s">"-n"</span><span class="o">,</span> <span class="s">"--number"</span> <span class="o">})</span>
    <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">3</span><span class="o">;</span> <span class="c1">// default to 3</span>

    <span class="c1">// This method would be called automatically</span>
    <span class="c1">// Both arguments of the run() methods can be omitted</span>
    <span class="kt">void</span> <span class="nf">run</span><span class="o">(</span><span class="n">OptionParser</span> <span class="n">parser</span><span class="o">,</span> <span class="n">String</span><span class="o">[]</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
        <span class="k">if</span> <span class="o">(</span><span class="n">verbose</span><span class="o">)</span> <span class="o">{</span> <span class="c1">// 'verbose' is set to true by the parser</span>
            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">n</span><span class="o">);</span> <span class="c1">// =&gt; 4</span>
            <span class="k">for</span> <span class="o">(</span><span class="n">String</span> <span class="n">param</span> <span class="o">:</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">param</span><span class="o">);</span>
            <span class="o">}</span>
        <span class="o">}</span>
    <span class="o">}</span>
<span class="o">}</span>

<span class="c1">// assume this is called with 'java TheMain --verbose -n 4 a b'</span>
<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">OptionParser</span> <span class="n">parser</span> <span class="o">=</span> <span class="k">new</span> <span class="n">OptionParser</span><span class="o">(</span><span class="n">FooCommand</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
    <span class="n">parser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">args</span><span class="o">);</span>
<span class="o">}</span>
</pre></div>

<h2>Understanding Rop</h2>

<p>The most significant thing in Rop is the <code>OptionParser</code> class, with which Commands are registered, then you call its <code>parse()</code> method to parse the command line arguments.</p>

<h3>The <code>@Command</code> Annotation</h3>

<p>Any vanilla class can be turned to a valid Command with the <code>@Command</code> annotation.</p>

<h3>The <code>@Option</code> Annotation</h3>

<p>In a Command class, those fields having the <code>@Option</code> annotation, are viable to be set from command line argments during parsing. The above example should make it pretty clear.</p>

<h3>Command Registration</h3>

<p>The <code>OptionParser</code> class provides a <code>register()</code> method to allow a Command, i.e. a class annotated with <code>@Command</code>, or its instance, to be registered with the parser. The <code>register()</code> method is chainable, as it always returns the parser object.</p>

<p>A Command can also be registered by passing it directly to the constructor <code>OptionParser()</code>, so you don't have to explicitly call the <code>register()</code> method. Also, the constructor can be called with any number of Commands.</p>

<h3>Post Parsing Hook - Method <code>run</code>
</h3>

<p>A Command can have a little magic. If it has a <code>run()</code> method, the parser would call this method at the end of parsing if the Command appeared in the command line.</p>

<p>In the above example,  <code>FooCommand.run()</code> would be called automatically, it would receive a reference to the parser itself, and an array which consists of all the remaining arguments.</p>

<p>If you're not interested in getting either the parser or the parameters, just omit any of them, or both.</p>

<p>Note that if there're more than one <code>run()</code> method, only the first would be called.</p>

<h3>Sub Command</h3>

<p>Typical commands, such as <a href="http://en.wikipedia.org/wiki/Mv"><code>mv</code></a> and <a href="http://en.wikipedia.org/wiki/Ls"><code>ls</code></a> in Unix, are quite simple, they're designed to <a href="http://en.wikipedia.org/wiki/Unix_philosophy">do one thing and do it well</a>.</p>

<p>However, not everything is simple. <a href="http://git-scm.com/">Git</a> provides a bunch of sub-commands to do many different things, such as <code>git add</code>, <code>git commit</code> and <code>git log</code>.</p>

<p>With Rop, you can register just one Command to build a simple command like <code>mv</code>, you can also register multiple Commands to support sub-commands like Git.</p>

<p>Though Git provides many sub-commands, you can only use one sub-command at a time, for example, in <code>git add ... commit ...</code>, the argument 'commit' loses its magic and would be treated as something to be added with <code>git add</code>, not the sub-command <code>git commit</code>.</p>

<p>But for <a href="http://ant.apache.org/">Ant</a> and <a href="http://maven.apache.org/">Maven</a>, it's a different story. As in <code>mvn clean test</code>, you can run multiple sub-commands together. Can we do that as well? Sure, it's actually very simple:</p>

<p>Rather than calling</p>

<div class="highlight"><pre><span class="n">parser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">args</span><span class="o">)</span>
</pre></div>

<p>instead, call</p>

<div class="highlight"><pre><span class="n">parser</span><span class="o">.</span><span class="na">parse</span><span class="o">(</span><span class="n">args</span><span class="o">,</span> <span class="kc">true</span><span class="o">)</span>
</pre></div>

<p>The extra boolean argument, when set to 'true', tells the parser to recognize all the sub-commands it detected. For each properly recognized sub-command, its <code>run()</code> method, if exists, would be called, in the order they appeared on the command line.</p>

<h3>Supported Field Types and Default Values</h3>

<ul>
<li>String, and all primitive type and their wrapper types are directly supported.</li>
<li>File, Path are supported as well, but not Date/Time yet.</li>
<li>There might be a customizable type binder available in the future.</li>
</ul><p>As in the above example, a default option value can be directly set to its associated field. If not set, the option values default to their type default, as list above, according to Java Tutorial - <a href="http://docs.oracle.com/javase/tutorial/java/nutsandbolts/datatypes.html">Primitive Data Types</a>.</p>

<pre>
Types                   Default Values
boolean                 false
byte                    0
short                   0
int                     0
long                    0L
float                   0.0f
double                  0.0d
char                    '\u0000'
String/Wrapper/Object   null
</pre>

<h3>Built-in Help</h3>

<p>If option '--help' is present, the parser will:</p>

<ol>
<li>display help information constructed from the Commands/Options annotations</li>
<li>call System.exit(0)</li>
</ol><h3>Error Handling</h3>

<p>Any possible error would be thrown as a RuntimeException, or its subclass, provided with proper error massege. You might want to catch the exceptions, print the error message and/or the help information before exiting the program. This is intentionally left to you so that you can control how your program behaves upon parsing errors before terminating.</p>

<h2>Contributing</h2>

<p>If you'd like to help improve Rop, clone the project with Git by running:</p>

<pre><code>$ git clone https://github.com/ryenus/rop
</code></pre>

<p>Work your magic and then submit a pull request. We love pull requests!</p>

<p>If you don't have the time to work on Rop, but found something we should know about, please submit an issue.</p>

<h2>License</h2>

<p>Rop is released under the <a href="http://www.opensource.org/licenses/MIT">MIT License</a>.</p>

<h2>Related projects</h2>

<ul>
<li><a href="https://github.com/arenn/java-getopt">java-getopt</a></li>
<li><a href="http://pholser.github.com/jopt-simple">JOpt Simple</a></li>
<li><a href="https://github.com/cbeust/jcommander">JCommander</a></li>
<li><a href="http://commons.apache.org/proper/commons-cli/">Commons CLI</a></li>
<li><a href="https://code.google.com/p/joptparse">joptparse</a></li>
</ul>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/ryenus">ryenus</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-39711562-1', 'github.com');
  ga('send', 'pageview');
</script>

  </body>
</html>
